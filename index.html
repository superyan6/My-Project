<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>音乐播放器</title>
  <link rel="stylesheet" href="./css/style.css">
  <link rel="stylesheet" href="./css/components.css">
  <link rel="stylesheet" href="./css/mini-player.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <!-- 确保在移动设备上有更好的触控体验 -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#181818">
  <style>
    /* 移动设备触摸优化 */
    * {
      -webkit-tap-highlight-color: transparent;
    }
    
    button {
      touch-action: manipulation;
    }
    
    /* Netease Cloud Music Style */
    :root {
      --primary-color: #d32f2f;
      --secondary-color: #333;
      --background-color: #121212;
      --card-background: #181818;
      --card-hover: #282828;
      --text-primary: #fff;
      --text-secondary: #b3b3b3;
      --border-color: #282828;
      --header-height: 64px;
      --sidebar-width: 240px;
    }

    body {
      background-color: var(--background-color);
      color: var(--text-primary);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      padding: 0;
      line-height: 1.6;
    }

    .app-container {
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    /* Sidebar Styles */
    .sidebar {
      width: var(--sidebar-width);
      background-color: #000;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
      display: flex;
      flex-direction: column;
    }

    .sidebar-header {
      padding: 20px 24px;
    }

    .app-logo {
      font-size: 24px;
      font-weight: bold;
      color: var(--primary-color);
    }

    .sidebar-nav {
      flex: 1;
      padding: 20px 0;
    }

    .nav-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .nav-item {
      margin: 4px 0;
    }

    .nav-link {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 12px 24px;
      color: var(--text-secondary);
      text-decoration: none;
      transition: all 0.2s ease;
    }

    .nav-link:hover {
      background-color: var(--card-hover);
      color: var(--text-primary);
    }

    .nav-item.active .nav-link {
      background-color: var(--card-hover);
      color: var(--primary-color);
      font-weight: 600;
    }

    .nav-icon {
      font-size: 20px;
      width: 24px;
      text-align: center;
    }

    .sidebar-footer {
      padding: 20px 24px;
      border-top: 1px solid var(--border-color);
    }

    .user-profile {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background-color: var(--primary-color);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    .username {
      font-size: 14px;
    }

    /* Main Content Styles */
    .main-content {
      margin-left: var(--sidebar-width);
      flex: 1;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
    }

    .top-bar {
      height: var(--header-height);
      background-color: rgba(18, 18, 18, 0.95);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 32px;
      border-bottom: 1px solid var(--border-color);
    }

    .search-container {
      flex: 1;
      max-width: 500px;
    }

    .search-box {
      display: flex;
      align-items: center;
      background-color: var(--card-background);
      border-radius: 20px;
      padding: 0 16px;
      height: 40px;
    }

    .search-icon {
      color: var(--text-secondary);
      margin-right: 8px;
    }

    .search-input {
      flex: 1;
      background: transparent;
      border: none;
      color: var(--text-primary);
      outline: none;
      height: 100%;
    }

    .top-actions {
      display: flex;
      gap: 16px;
    }

    .action-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background-color: var(--card-background);
      border: none;
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .action-btn:hover {
      background-color: var(--card-hover);
      color: var(--text-primary);
    }

    .content {
      flex: 1;
      overflow-y: auto;
      padding: 32px;
    }

    /* Hero Section */
    .hero-section {
      background: linear-gradient(135deg, var(--primary-color), #ff5722);
      border-radius: 12px;
      padding: 40px;
      margin-bottom: 40px;
      color: white;
      display: flex;
      align-items: center;
      gap: 32px;
    }

    .hero-content {
      flex: 1;
    }

    .hero-title {
      font-size: 32px;
      font-weight: 800;
      margin-bottom: 16px;
    }

    .hero-subtitle {
      font-size: 16px;
      margin-bottom: 24px;
      opacity: 0.9;
    }

    .hero-btn {
      background-color: white;
      color: var(--primary-color);
      border: none;
      padding: 12px 24px;
      border-radius: 24px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .hero-btn:hover {
      transform: scale(1.05);
    }

    .hero-image {
      width: 240px;
      height: 240px;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .hero-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* Section Styles */
    .section {
      margin-bottom: 40px;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }
    
    .section-title {
      font-size: 24px;
      font-weight: 700;
      margin: 0;
    }
    
    .section-link {
      color: var(--primary-color);
      text-decoration: none;
      font-weight: 500;
    }
    
    .section-more {
      color: var(--text-secondary);
      text-decoration: none;
      font-size: 14px;
      transition: color 0.2s ease;
    }

    .section-more:hover {
      color: var(--text-primary);
    }

    /* Tracks Grid */
    .featured-tracks {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 24px;
      margin-top: 32px;
    }
    
    .track-card {
      background-color: var(--card-background);
      border-radius: 8px;
      padding: 20px;
      transition: all 0.3s ease;
      cursor: pointer;
      border: 1px solid var(--border-color);
    }
    
    .track-card:hover {
      background-color: var(--card-hover);
      transform: translateY(-2px);
    }
    
    .track-cover {
      width: 100%;
      aspect-ratio: 1;
      border-radius: 8px;
      overflow: hidden;
      margin-bottom: 16px;
      position: relative;
    }
    
    .track-cover img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .track-cover:hover .play-overlay {
      opacity: 1;
    }
    
    .play-overlay {
      position: absolute;
      bottom: 8px;
      right: 8px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: var(--primary-color);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.2s ease;
    }
    
    .track-info {
      overflow: hidden;
    }
    
    .track-name {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 8px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .track-artist {
      font-size: 14px;
      color: var(--text-secondary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Recently Played */
    .recently-played {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 24px;
    }

    .recent-track {
      display: flex;
      align-items: center;
      gap: 12px;
      background-color: var(--card-background);
      padding: 12px;
      border-radius: 8px;
      transition: background-color 0.2s ease;
    }

    .recent-track:hover {
      background-color: var(--card-hover);
    }

    /* Playlist Grid */
    .playlist-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 24px;
    }

    .playlist-card {
      background-color: var(--card-background);
      border-radius: 8px;
      padding: 20px;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .playlist-card:hover {
      background-color: var(--card-hover);
      transform: translateY(-2px);
    }

    .playlist-cover {
      width: 100%;
      aspect-ratio: 1;
      border-radius: 8px;
      overflow: hidden;
      margin-bottom: 16px;
    }

    .playlist-cover img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .playlist-name {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    /* Artists Grid */
    .artists-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 24px;
    }

    .artist-card {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      cursor: pointer;
    }

    .artist-image {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      overflow: hidden;
      margin-bottom: 16px;
      border: 3px solid var(--border-color);
      transition: all 0.3s ease;
    }

    .artist-card:hover .artist-image {
      border-color: var(--primary-color);
      transform: scale(1.05);
    }

    .artist-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .artist-name {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .artist-followers {
      font-size: 14px;
      color: var(--text-secondary);
    }

    /* Bottom Player */
    .bottom-player {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 96px;
      background-color: #181818;
      border-top: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      padding: 0 24px;
      z-index: 1000;
    }

    .player-container {
      display: flex;
      align-items: center;
      gap: 32px;
      width: 100%;
    }

    .now-playing {
      display: flex;
      align-items: center;
      gap: 16px;
      width: 30%;
    }

    .song-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .song-cover {
      width: 64px;
      height: 64px;
      border-radius: 4px;
      overflow: hidden;
    }

    .song-cover img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .song-details h4 {
      margin: 0 0 4px 0;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .song-details p {
      margin: 0;
      font-size: 12px;
      color: var(--text-secondary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .favorite-btn {
      background: none;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      font-size: 18px;
      transition: color 0.2s ease;
    }

    .favorite-btn.active {
      color: var(--primary-color);
    }

    .player-controls {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
    }

    .control-buttons {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .control-btn {
      background: none;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      transition: color 0.2s ease;
    }

    .control-btn:hover {
      color: var(--text-primary);
    }

    .play-pause-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: var(--text-primary);
      color: var(--secondary-color);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      transition: all 0.2s ease;
    }

    .play-pause-btn:hover {
      background-color: #fff;
      transform: scale(1.05);
    }

    .progress-container {
      display: flex;
      align-items: center;
      gap: 12px;
      width: 100%;
      max-width: 600px;
    }

    .time {
      font-size: 12px;
      color: var(--text-secondary);
      width: 45px;
      text-align: center;
    }

    .progress-bar {
      flex: 1;
      height: 4px;
      background-color: var(--border-color);
      border-radius: 2px;
      position: relative;
      cursor: pointer;
      transition: height 0.2s ease;
    }

    .progress-bar:hover {
      height: 6px;
    }

    .progress-fill {
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 30%;
      background-color: var(--primary-color);
      border-radius: 2px;
      transition: width 0.1s linear;
    }

    .volume-control {
      display: flex;
      align-items: center;
      gap: 12px;
      width: 20%;
      justify-content: flex-end;
    }

    .volume-slider-container {
      width: 100px;
    }

    #volume-slider {
      width: 100%;
      height: 4px;
      background-color: var(--border-color);
      border-radius: 2px;
      outline: none;
      -webkit-appearance: none;
    }

    #volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    #volume-slider::-webkit-slider-thumb:hover {
      background-color: var(--primary-color);
      transform: scale(1.2);
    }

    .playlist-btn {
      background: none;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      font-size: 18px;
      transition: color 0.2s ease;
    }

    .playlist-btn:hover {
      color: var(--text-primary);
    }

    /* Playlist Panel */
    .playlist-panel {
      position: fixed;
      bottom: 96px;
      right: 0;
      width: 380px;
      height: 0;
      background-color: var(--card-background);
      border-left: 1px solid var(--border-color);
      border-top: 1px solid var(--border-color);
      border-radius: 8px 8px 0 0;
      overflow: hidden;
      transition: height 0.3s ease;
      z-index: 999;
    }

    .playlist-panel.active {
      height: 400px;
    }

    .playlist-header {
      padding: 20px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .playlist-header h3 {
      margin: 0;
      font-size: 18px;
    }

    .close-btn {
      background: none;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      font-size: 18px;
      transition: color 0.2s ease;
    }

    .close-btn:hover {
      color: var(--text-primary);
    }

    .playlist-content {
      height: calc(100% - 60px);
      overflow-y: auto;
    }

    .playlist-items {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .playlist-item {
      display: flex;
      align-items: center;
      padding: 12px 20px;
      border-bottom: 1px solid var(--border-color);
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .playlist-item:hover {
      background-color: var(--card-hover);
    }

    .playlist-item.active {
      background-color: var(--card-hover);
    }

    .playlist-item-number {
      color: var(--text-secondary);
      margin-right: 16px;
      font-size: 14px;
    }

    .playlist-item-info {
      flex: 1;
    }

    .playlist-item-title {
      font-size: 14px;
      margin-bottom: 4px;
    }

    .playlist-item-artist {
      font-size: 12px;
      color: var(--text-secondary);
    }

    .playlist-item-duration {
      color: var(--text-secondary);
      font-size: 14px;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }
      
      .sidebar.active {
        transform: translateX(0);
      }
      
      .main-content {
        margin-left: 0;
      }
      
      .hero-section {
        flex-direction: column;
        text-align: center;
      }
      
      .hero-image {
        width: 200px;
        height: 200px;
      }
      
      .player-container {
        flex-direction: column;
        gap: 16px;
      }
      
      .now-playing,
      .volume-control {
        width: 100%;
      }
      
      .playlist-panel {
        width: 100%;
      }
    }
  </style>
    <!-- 通知和设置面板样式 -->
    <style>
      /* 通知角标样式 */
      .notification-badge {
        position: absolute;
        top: -4px;
        right: -4px;
        background-color: var(--primary-color);
        color: white;
        border-radius: 50%;
        width: 18px;
        height: 18px;
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
      }
      
      /* 通知面板样式 */
      .notification-panel {
        position: fixed;
        top: 64px;
        right: 20px;
        width: 380px;
        max-height: 500px;
        background-color: var(--card-background);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        z-index: 1001;
        display: none;
        overflow: hidden;
      }
      
      .notification-panel.active {
        display: block;
      }
      
      .notification-header {
        padding: 16px 20px;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      
      .notification-header h3 {
        margin: 0;
        font-size: 18px;
      }
      
      .notification-header button {
        background: none;
        border: none;
        color: var(--text-secondary);
        cursor: pointer;
        font-size: 16px;
      }
      
      .notification-header button:hover {
        color: var(--text-primary);
      }
      
      .notification-list {
        max-height: 400px;
        overflow-y: auto;
      }
      
      .notification-item {
        padding: 16px 20px;
        border-bottom: 1px solid var(--border-color);
        cursor: pointer;
        transition: background-color 0.2s ease;
      }
      
      .notification-item:hover {
        background-color: var(--card-hover);
      }
      
      .notification-item.unread {
        background-color: rgba(211, 47, 47, 0.1);
      }
      
      .notification-content {
        font-size: 14px;
        margin-bottom: 4px;
      }
      
      .notification-time {
        font-size: 12px;
        color: var(--text-secondary);
      }
      
      /* 设置面板样式 */
      .settings-panel {
        position: fixed;
        top: 64px;
        right: 20px;
        width: 380px;
        background-color: var(--card-background);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        z-index: 1001;
        display: none;
        overflow: hidden;
      }
      
      .settings-panel.active {
        display: block;
      }
      
      .settings-header {
        padding: 16px 20px;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      
      .settings-header h3 {
        margin: 0;
        font-size: 18px;
      }
      
      .settings-header button {
        background: none;
        border: none;
        color: var(--text-secondary);
        cursor: pointer;
        font-size: 16px;
      }
      
      .settings-header button:hover {
        color: var(--text-primary);
      }
      
      .settings-content {
        padding: 20px;
      }
      
      .setting-item {
        margin-bottom: 20px;
      }
      
      .setting-item:last-child {
        margin-bottom: 0;
      }
      
      .setting-label {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
        font-size: 14px;
      }
      
      .setting-description {
        font-size: 12px;
        color: var(--text-secondary);
        margin-bottom: 8px;
      }
      
      /* 开关按钮样式 */
      .toggle-switch {
        position: relative;
        display: inline-block;
        width: 48px;
        height: 24px;
      }
      
      .toggle-switch input {
        opacity: 0;
        width: 0;
        height: 0;
      }
      
      .toggle-slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: var(--border-color);
        transition: .4s;
        border-radius: 24px;
      }
      
      .toggle-slider:before {
        position: absolute;
        content: "";
        height: 20px;
        width: 20px;
        left: 2px;
        bottom: 2px;
        background-color: white;
        transition: .4s;
        border-radius: 50%;
      }
      
      input:checked + .toggle-slider {
        background-color: var(--primary-color);
      }
      
      input:checked + .toggle-slider:before {
        transform: translateX(24px);
      }
      
      /* 滑块样式 */
      .setting-slider {
        width: 100%;
        height: 4px;
        background-color: var(--border-color);
        border-radius: 2px;
        outline: none;
        -webkit-appearance: none;
      }
      
      .setting-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background-color: var(--text-secondary);
        cursor: pointer;
        transition: all 0.2s ease;
      }
      
      .setting-slider::-webkit-slider-thumb:hover {
        background-color: var(--primary-color);
        transform: scale(1.2);
      }
      
      /* 响应式调整 */
      @media (max-width: 768px) {
        .notification-panel,
        .settings-panel {
          width: calc(100% - 40px);
          right: 20px;
        }
      }
    </style>
</head>
<body>
  <div class="app-container">
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="app-logo">My Music Vault</div>
      </div>
      
      <nav class="sidebar-nav">
        <ul class="nav-list">
          <li class="nav-item active">
            <a href="index.html" class="nav-link">
              <span class="nav-icon"><i class="fas fa-home"></i></span>
              Home
            </a>
          </li>
          <li class="nav-item">
            <a href="favorites.html" class="nav-link">
              <span class="nav-icon"><i class="fas fa-heart"></i></span>
              My Favorites
            </a>
          </li>
          <li class="nav-item">
            <a href="recent.html" class="nav-link">
              <span class="nav-icon"><i class="fas fa-history"></i></span>
              Recently Played
            </a>
          </li>
          <li class="nav-item">
            <a href="recommendations.html" class="nav-link">
              <span class="nav-icon"><i class="fas fa-compass"></i></span>
              Recommendations
            </a>
          </li>
        </ul>
      </nav>
      
      <div class="sidebar-footer">
        <div class="user-profile">
          <div class="avatar">JD</div>
          <span class="username">John Doe</span>
        </div>
      </div>
    </aside>
    
    <!-- Main Content Area -->
    <main class="main-content">
      <!-- Top Bar with Search -->
      <div class="top-bar">
        <div class="search-container">
          <div class="search-box">
            <span class="search-icon"><i class="fas fa-search"></i></span>
            <input type="text" class="search-input" placeholder="Search songs, artists, albums...">
          </div>
        </div>
        <div class="top-actions">
          <button id="notification-btn" class="action-btn" title="Notifications">
            <i class="fas fa-bell"></i>
            <span id="notification-badge" class="notification-badge" style="display: none;">3</span>
          </button>
          <button id="settings-btn" class="action-btn" title="Settings">
            <i class="fas fa-cog"></i>
          </button>
        </div>
      </div>
      
      <!-- Content Section -->
      <div class="content">
        <!-- Hero Section -->
        <div class="hero-section">
          <div class="hero-content">
            <h1 class="hero-title">Discover New Music</h1>
            <p class="hero-subtitle">Explore curated playlists and find your next favorite song</p>
            <button class="hero-btn" id="explore-now-btn">Explore Now</button>
          </div>
          <div class="hero-image">
            <img src="images/picture1.jpg" alt="Featured Playlist">
          </div>
        </div>
        
        <!-- 引入播放器脚本 -->
        <script src="player.js"></script>
        

        
        <!-- Recently Played Section -->
        <div class="section">
          <div class="section-header">
            <h2 class="section-title">Recently Played</h2>
            <a href="recent.html" class="section-more">See All <i class="fas fa-chevron-right"></i></a>
          </div>
          <div class="recently-played"></div>
        </div>
        
        <!-- For You Section -->
        <div class="section">
          <div class="section-header">
            <h2 class="section-title">For You</h2>
            <a href="recommendations.html" class="section-more">More <i class="fas fa-chevron-right"></i></a>
          </div>
          <div class="playlist-grid"></div>
        </div>
        
        <!-- Search Results Section -->
        <div class="section search-results-section" style="display: none;">
          <div class="section-header">
            <h2 class="section-title" id="search-results-title">搜索结果</h2>
          </div>
          <div class="featured-tracks search-results"></div>
        </div>

      </div>
    </main>
  </div>
  
  <!-- 底部迷你播放器 - 统一使用全局播放器 -->
  <div class="bottom-player">
      <!-- 歌曲信息区域 -->
      <div class="player-info">
          <img id="mini-player-cover" class="mini-player-cover" src="images/picture1.jpg" alt="专辑封面">
          <div class="track-details">
              <div id="mini-player-title" class="mini-player-title">未知歌曲</div>
              <div id="mini-player-artist" class="mini-player-artist">未知艺术家</div>
          </div>
          <button id="favorite-btn" title="收藏">
              <i class="far fa-heart"></i>
          </button>
      </div>
      
      <!-- 播放控制区域 -->
      <div class="player-controls">
          <div class="controls-buttons">
              <button id="shuffle-btn" class="control-btn" title="随机播放">
                  <i class="fas fa-random"></i>
              </button>
              <button id="prev-btn" class="control-btn" title="上一首">
                  <i class="fas fa-step-backward"></i>
              </button>
              <button id="play-pause-btn" class="control-btn" title="播放/暂停">
                  <i class="fas fa-play"></i>
              </button>
              <button id="next-btn" class="control-btn" title="下一首">
                  <i class="fas fa-step-forward"></i>
              </button>
              <button id="repeat-btn" class="control-btn" title="重复播放">
                  <i class="fas fa-redo"></i>
              </button>
          </div>
          <div class="progress-container">
              <span id="current-time">0:00</span>
              <div id="progress-bar">
                  <div id="progress-fill"></div>
              </div>
              <span id="total-time">0:00</span>
          </div>
      </div>
      
      <!-- 音量控制区域 -->
      <div class="player-volume">
          <button id="volume-btn" class="control-btn" title="音量控制">
              <i class="fas fa-volume-up"></i>
          </button>
          <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.8">
      </div>
  </div>
  
  <!-- Notification Panel -->
  <div id="notification-panel" class="notification-panel">
    <div class="notification-header">
      <h3>Notifications</h3>
      <button id="clear-notifications">Clear All</button>
    </div>
    <div class="notification-list">
      <div class="notification-item unread">
        <div class="notification-content">New album "Summer Vibes" is now available</div>
        <div class="notification-time">Today 12:30</div>
      </div>
      <div class="notification-item unread">
        <div class="notification-content">Your followed artist Jay Park released a new song</div>
        <div class="notification-time">Yesterday 18:45</div>
      </div>
      <div class="notification-item unread">
        <div class="notification-content">Your playlists have been synced</div>
        <div class="notification-time">2 days ago</div>
      </div>
      <div class="notification-item">
        <div class="notification-content">Welcome to Music Player!</div>
        <div class="notification-time">3 days ago</div>
      </div>
    </div>
  </div>
  
  <!-- Settings Panel -->
  <div id="settings-panel" class="settings-panel">
    <div class="settings-header">
      <h3>Settings</h3>
      <button id="close-settings"><i class="fas fa-times"></i></button>
    </div>
    <div class="settings-content">
      <div class="setting-item">
        <div class="setting-label">
          <span>Auto Play</span>
          <label class="toggle-switch">
            <input type="checkbox" id="auto-play-toggle" checked>
            <span class="toggle-slider"></span>
          </label>
        </div>
        <div class="setting-description">Automatically play next track when current ends</div>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span>Notifications</span>
          <label class="toggle-switch">
            <input type="checkbox" id="notification-toggle" checked>
            <span class="toggle-slider"></span>
          </label>
        </div>
        <div class="setting-description">Receive new album and event notifications</div>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span>Default Volume</span>
          <span id="volume-value">80%</span>
        </div>
        <input type="range" id="default-volume-slider" class="setting-slider" min="0" max="100" value="80">
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span>Audio Quality</span>
          <label class="toggle-switch">
            <input type="checkbox" id="high-quality-toggle">
            <span class="toggle-slider"></span>
          </label>
        </div>
        <div class="setting-description">High quality playback uses more data</div>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <span>Dark Mode</span>
          <label class="toggle-switch">
            <input type="checkbox" id="dark-mode-toggle" checked>
            <span class="toggle-slider"></span>
          </label>
        </div>
        <div class="setting-description">Use dark theme interface</div>
      </div>
    </div>
  </div>
  
  <!-- 播放列表面板 -->
  <div id="playlist-panel">
      <div class="playlist-header">
          <h3>播放列表</h3>
          <button id="close-playlist">
              <i class="fas fa-times"></i>
          </button>
      </div>
      <div id="playlist-items">
          <!-- 播放列表项目将通过JavaScript动态生成 -->
      </div>
  </div>
  
  <!-- 音频元素 - 使用单一全局音频元素 -->
  <audio id="audio-player" preload="metadata"></audio>
  
  <script src="js/data-loader.js"></script>
  <script src="js/player.js"></script>
  <script src="js/app.js"></script>
    
    <!-- 搜索功能和播放控制初始化 -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // 统一播放器初始化 - 确保使用全局播放器
        if (!window._globalAudioPlayer) {
          // 如果全局播放器还不存在，尝试创建
          const audioElement = document.getElementById('audio-player');
          if (audioElement && window.Player) {
            window._globalAudioPlayer = new Player(audioElement, []);
          }
        }

        // 获取搜索输入框
        const searchInput = document.querySelector('.search-input');
        
        // 添加输入事件监听
        searchInput.addEventListener('input', function() {
          const query = this.value;
          // 调用App实例的searchTracks方法
          if (window.appInstance) {
            window.appInstance.searchTracks(query);
          }
        });
        
        // 添加键盘事件处理
        searchInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            e.preventDefault();
            const query = this.value;
            if (window.appInstance) {
              window.appInstance.searchTracks(query);
            }
          }
        });
        
        // 确保App实例在DOM加载完成后初始化
        if (window.App && !window.appInstance) {
          // 延迟初始化以确保所有DOM元素都已加载
          setTimeout(() => {
            window.appInstance = App.getInstance();
            if (window.appInstance && !window.appInstance.isInitialized) {
              window.appInstance.initialize();
            }
          }, 100);
        }
        
        // 循环模式和随机播放功能
        let repeatMode = 0; // 0: 不循环, 1: 单曲循环, 2: 列表循环
        let isShuffle = false;
        
        // 获取音频元素引用
        const audioPlayer = document.getElementById('audio-player');
        
        // 为循环按钮添加功能
        const repeatBtn = document.getElementById('repeat-btn');
        if (repeatBtn) {
          repeatBtn.addEventListener('click', function() {
            // 切换循环模式
            repeatMode = (repeatMode + 1) % 3;
            
            // 更新按钮样式
            repeatBtn.className = 'control-btn';
            
            if (repeatMode === 1) {
              // 单曲循环
              repeatBtn.classList.add('repeat-one');
              repeatBtn.classList.add('active');
              if (audioPlayer) {
                audioPlayer.loop = true;
              }
            } else if (repeatMode === 2) {
              // 列表循环
              repeatBtn.classList.add('active');
              if (audioPlayer) {
                audioPlayer.loop = false;
              }
            } else {
              // 不循环
              if (audioPlayer) {
                audioPlayer.loop = false;
              }
            }
          });
        }
        
        // 为随机播放按钮添加功能
        const shuffleBtn = document.getElementById('shuffle-btn');
        if (shuffleBtn) {
          shuffleBtn.addEventListener('click', function() {
            isShuffle = !isShuffle;
            shuffleBtn.classList.toggle('active', isShuffle);
            
            // 这里可以根据需要实现随机播放逻辑
            // 例如，如果有播放列表，可以打乱播放顺序
          });
        }
        
        // 为音频元素添加ended事件处理
        if (audioPlayer) {
          audioPlayer.addEventListener('ended', function() {
            if (repeatMode === 0) {
              // 不循环
              if (window.player && window.player.updatePlayPauseButton) {
                window.player.updatePlayPauseButton();
              }
            } else if (repeatMode === 1) {
              // 单曲循环已经通过audio.loop实现
              audioPlayer.play();
            } else if (repeatMode === 2) {
              // 列表循环，播放下一首
              const nextBtn = document.getElementById('next-btn');
              if (nextBtn) {
                nextBtn.click();
              }
            }
          });
        }
      });
    </script>
    
    <!-- 通知和设置面板功能 -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // 获取DOM元素
        const notificationBtn = document.getElementById('notification-btn');
        const notificationPanel = document.getElementById('notification-panel');
        const notificationBadge = document.getElementById('notification-badge');
        const clearNotificationsBtn = document.getElementById('clear-notifications');
        const notificationItems = document.querySelectorAll('.notification-item');
        
        const settingsBtn = document.getElementById('settings-btn');
        const settingsPanel = document.getElementById('settings-panel');
        const closeSettingsBtn = document.getElementById('close-settings');
        
        const autoPlayToggle = document.getElementById('auto-play-toggle');
        const notificationToggle = document.getElementById('notification-toggle');
        const highQualityToggle = document.getElementById('high-quality-toggle');
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        const defaultVolumeSlider = document.getElementById('default-volume-slider');
        const volumeValue = document.getElementById('volume-value');
        
        // 从localStorage加载设置
        function loadSettings() {
          const autoPlay = localStorage.getItem('musicAppAutoPlay');
          if (autoPlay !== null) {
            autoPlayToggle.checked = autoPlay === 'true';
          }
          
          const notifications = localStorage.getItem('musicAppNotifications');
          if (notifications !== null) {
            notificationToggle.checked = notifications === 'true';
          }
          
          const highQuality = localStorage.getItem('musicAppHighQuality');
          if (highQuality !== null) {
            highQualityToggle.checked = highQuality === 'true';
          }
          
          const darkMode = localStorage.getItem('musicAppDarkMode');
          if (darkMode !== null) {
            darkModeToggle.checked = darkMode === 'true';
          }
          
          const volume = localStorage.getItem('musicAppVolume');
          if (volume !== null) {
            defaultVolumeSlider.value = volume;
            volumeValue.textContent = `${volume}%`;
            // 应用到音频播放器
            const audio = document.getElementById('audio-player');
            if (audio) {
              audio.volume = volume / 100;
            }
          }
        }
        
        // 保存设置到localStorage
        function saveSettings() {
          localStorage.setItem('musicAppAutoPlay', autoPlayToggle.checked);
          localStorage.setItem('musicAppNotifications', notificationToggle.checked);
          localStorage.setItem('musicAppHighQuality', highQualityToggle.checked);
          localStorage.setItem('musicAppDarkMode', darkModeToggle.checked);
          localStorage.setItem('musicAppVolume', defaultVolumeSlider.value);
        }
        
        // 切换通知面板显示/隐藏
        notificationBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          notificationPanel.classList.toggle('active');
          settingsPanel.classList.remove('active');
          
          // 显示时检查未读通知数量
          if (notificationPanel.classList.contains('active')) {
            updateNotificationBadge();
          }
        });
        
        // 切换设置面板显示/隐藏
        settingsBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          settingsPanel.classList.toggle('active');
          notificationPanel.classList.remove('active');
        });
        
        // 关闭设置面板
        closeSettingsBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          settingsPanel.classList.remove('active');
        });
        
        // 更新通知角标
        function updateNotificationBadge() {
          const unreadCount = document.querySelectorAll('.notification-item.unread').length;
          if (unreadCount > 0) {
            notificationBadge.textContent = unreadCount;
            notificationBadge.style.display = 'flex';
          } else {
            notificationBadge.style.display = 'none';
          }
        }
        
        // 通知项点击事件 - 标记为已读
        notificationItems.forEach(item => {
          item.addEventListener('click', function(e) {
            e.stopPropagation();
            this.classList.remove('unread');
            updateNotificationBadge();
            
            // 触发自定义事件，便于其他组件响应通知点击
            const event = new CustomEvent('notificationClicked', {
              detail: {
                content: this.querySelector('.notification-content').textContent,
                time: this.querySelector('.notification-time').textContent
              }
            });
            window.dispatchEvent(event);
          });
        });
        
        // 清除所有通知
        clearNotificationsBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          const notificationList = document.querySelector('.notification-list');
          notificationList.innerHTML = '<div class="notification-item"><div class="notification-content">暂无通知</div></div>';
          notificationBadge.style.display = 'none';
          
          // 触发清除通知事件
          window.dispatchEvent(new Event('notificationsCleared'));
        });
        
        // 设置项事件监听
        autoPlayToggle.addEventListener('change', function() {
          saveSettings();
          // 触发设置变更事件
          window.dispatchEvent(new CustomEvent('settingChanged', {
            detail: { setting: 'autoPlay', value: this.checked }
          }));
        });
        
        notificationToggle.addEventListener('change', function() {
          saveSettings();
          window.dispatchEvent(new CustomEvent('settingChanged', {
            detail: { setting: 'notifications', value: this.checked }
          }));
        });
        
        highQualityToggle.addEventListener('change', function() {
          saveSettings();
          window.dispatchEvent(new CustomEvent('settingChanged', {
            detail: { setting: 'highQuality', value: this.checked }
          }));
        });
        
        darkModeToggle.addEventListener('change', function() {
          saveSettings();
          // 触发设置变更事件
          window.dispatchEvent(new CustomEvent('settingChanged', {
            detail: { setting: 'darkMode', value: this.checked }
          }));
        });
        
        // 音量滑块事件
        defaultVolumeSlider.addEventListener('input', function() {
          volumeValue.textContent = `${this.value}%`;
          // 实时更新音频播放器音量
          const audio = document.getElementById('audio-player');
          if (audio) {
            audio.volume = this.value / 100;
          }
        });
        
        defaultVolumeSlider.addEventListener('change', function() {
          saveSettings();
          window.dispatchEvent(new CustomEvent('settingChanged', {
            detail: { setting: 'volume', value: parseInt(this.value) }
          }));
        });
        
        // 点击页面其他区域关闭面板
        document.addEventListener('click', function(e) {
          if (!notificationPanel.contains(e.target) && e.target !== notificationBtn && !notificationBtn.contains(e.target)) {
            notificationPanel.classList.remove('active');
          }
          if (!settingsPanel.contains(e.target) && e.target !== settingsBtn && !settingsBtn.contains(e.target)) {
            settingsPanel.classList.remove('active');
          }
        });
        
        // 添加键盘ESC键关闭面板
        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') {
            notificationPanel.classList.remove('active');
            settingsPanel.classList.remove('active');
          }
        });
        
        // 导出方法供其他脚本使用
        window.notificationAPI = {
          showNotification: function(content, isUnread = true) {
            const notificationList = document.querySelector('.notification-list');
            const newNotification = document.createElement('div');
            newNotification.className = `notification-item ${isUnread ? 'unread' : ''}`;
            
            const now = new Date();
            const timeStr = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            newNotification.innerHTML = `
              <div class="notification-content">${content}</div>
              <div class="notification-time">${timeStr}</div>
            `;
            
            notificationList.insertBefore(newNotification, notificationList.firstChild);
            
            // 添加点击事件
            newNotification.addEventListener('click', function(e) {
              e.stopPropagation();
              this.classList.remove('unread');
              updateNotificationBadge();
            });
            
            updateNotificationBadge();
            return newNotification;
          },
          
          getUnreadCount: function() {
            return document.querySelectorAll('.notification-item.unread').length;
          }
        };
        
        // 初始化
        loadSettings();
        updateNotificationBadge();
      });
    </script>
    
    <script src="./js/mini-player.js"></script>
    <script>
        // 补丁：为MiniPlayer类添加缺失的clearTracks和addTrack方法
        if (window.MiniPlayer) {
            MiniPlayer.prototype.clearTracks = function() {
                this.tracks = [];
            };
            
            MiniPlayer.prototype.addTrack = function(track) {
                this.tracks.push(track);
            };
        }
    </script>
    <script>
        // 全局播放器同步事件监听
        window.addEventListener('tracksUpdated', function(event) {
            if (window.player && typeof window.player.updatePlaylist === 'function') {
                window.player.tracks = event.detail.tracks || [];
                window.player.currentTrackIndex = event.detail.currentTrackIndex || 0;
                window.player.updatePlaylist();
            }
        });
        
        window.addEventListener('playStateChanged', function(event) {
            if (window.player) {
                window.player.isPlaying = event.detail.isPlaying || false;
                window.player.currentTrackIndex = event.detail.currentTrackIndex || 0;
                if (typeof window.player.updatePlayPauseButton === 'function') {
                    window.player.updatePlayPauseButton();
                }
                if (typeof window.player.updatePlaylistHighlight === 'function') {
                    window.player.updatePlaylistHighlight();
                }
            }
        });
        
        window.addEventListener('trackChanged', function(event) {
            if (window.player) {
                window.player.currentTrackIndex = event.detail.trackIndex || 0;
                window.player.tracks = event.detail.track ? [event.detail.track] : [];
                if (typeof window.player.prepareTrack === 'function') {
                    window.player.prepareTrack(event.detail.trackIndex);
                }
                if (typeof window.player.updateTrackInfo === 'function') {
                    window.player.updateTrackInfo();
                }
                if (typeof window.player.updatePlaylistHighlight === 'function') {
                    window.player.updatePlaylistHighlight();
                }
            }
        });
        
        window.addEventListener('playModeChanged', function(event) {
            if (window.player) {
                window.player.isShuffle = event.detail.isShuffle || false;
                window.player.repeatMode = event.detail.repeatMode || 0;
                if (typeof window.player.updateShuffleButton === 'function') {
                    window.player.updateShuffleButton();
                }
                if (typeof window.player.updateRepeatButton === 'function') {
                    window.player.updateRepeatButton();
                }
            }
        });
    </script>
    
    <!-- 搜索功能实现 -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
          const searchInput = document.querySelector(".search-input");
          if (!searchInput) return;

          searchInput.addEventListener("input", function () {
            const query = this.value.toLowerCase();

            // 针对不同页面的元素类型自动筛选
            const items = document.querySelectorAll(
              ".song-list-item, .track-card, .card, .album-card, .daily-rec-item"
            );

            items.forEach((item) => {
              const text = item.textContent.toLowerCase();
              item.style.display = text.includes(query) ? "" : "none";
            });
          });
        });
    </script>
    
    <!-- 音量控制脚本 -->
    <script src="./js/volume-control.js"></script>
</body>
</html>